# Automate Duty - Process CSV file on Trust Windows PC

The `process_duty_csv.py` script processes the end of duty CSV files generated by [duty_csv](https://github.com/moka-guys/duty_csv), downloading the files to CSV-defined locations. All runfolder-specific inputs are stored in the CSV file; this performs the download based on these inputs to reduce overhead in
future updates.

The script is currently hard-coded to process CSV files located at:

```
P:\Bioinformatics\Duty_Bioinformatics_CSV
```

## Usage

The script is only functional on the GSTT network.

Instructions for running the script are detailed within the emails with the CSV attachments.

To run the production script, it is recommended to set up a powershell alias by following the instructions in the powershell tricks KB article in ServiceNow. There is also a KB article in ServiceNow with more detailed instructions on how to use the scripts together correctly.

### Test area

All testing should be performed in the test area on the GSTT network at:
```
P:\Bioinformatics\testing\process_duty_csv\
```

Testing should be performed using CSV files generated from recent runs using
the [duty_csv](https://github.com/moka-guys/duty_csv) or [dnanexus_duty_csv](https://github.com/moka-guys/dnanexus_duty_csv) repository in test mode, as these CSV files will contain test-specific paths to ensure all output files are placed in the test area only.

### Production area

This repository is deployed on the GSTT network at:

```
S:\Genetics_Data2\Array\Software\process_duty_csv\
```

## Output

* **DNAnexus output files** - Placed in the locations specified within the CSV file
* **Log file** - Saved in the `process_logs` containing log messages detailing the script logic
* **Commands log file** - Saved in the `cmds_logs` subdirectory, containing the commands generated by the script
* **Archived CSV** - Upon successful download of all files, the script will move the CSV file to the archive folder in an `archive` subdirectory (if an error occurs, the CSV file will not be moved)


### Developed by the Synnovis Genome Informatics Team
